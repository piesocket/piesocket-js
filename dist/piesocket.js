var PieSocket;PieSocket=(()=>{var e={306:e=>{"use strict";e.exports=JSON.parse('{"name":"piesocket-js","version":"1.0.14","description":"PieSocket Javascript Client","main":"src/index.js","unpkg":"dist/piesocket.js","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1","start":"webpack --mode=development --config webpack.dev.js serve","build":"webpack --mode=production --config webpack.prod.js","prepare":"npm run build","watch":"webpack --mode=development --config webpack.dev.js --watch"},"repository":{"type":"git","url":"git+https://github.com/piesocket/piesocket-js.git"},"keywords":["piesocket","client","websocket","pubsub","http"],"author":"PieSocket","license":"MIT","bugs":{"url":"https://github.com/piesocket/piesocket-js/issues"},"homepage":"https://github.com/piesocket/piesocket-js#readme","devDependencies":{"@webpack-cli/serve":"^1.1.0","webpack":"^5.9.0","webpack-cli":"^4.2.0","webpack-dev-server":"^3.11.0","webpack-merge":"^5.4.0"}}')},897:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});class o{constructor(e){this.options=e}log(...e){this.options.consoleLogs&&console.log(...e)}warn(...e){this.options.consoleLogs&&console.warn(...e)}error(...e){this.options.consoleLogs&&console.error(...e)}}class n{constructor(e,t){this.endpoint=e,this.identity=t,this.connection=this.connect(),this.events={},this.shouldReconnect=!1,this.logger=new o(t)}connect(){var e=new WebSocket(this.endpoint);return e.onmessage=this.onMessage.bind(this),e.onopen=this.onOpen.bind(this),e.onerror=this.onError.bind(this),e.onclose=this.onClose.bind(this),e}on(e,t){this.events[e]=t}onMessage(e){this.logger.log("Channel message:",e);try{JSON.parse(e.data).error.length&&(this.shouldReconnect=!1)}catch(e){}this.events.message&&this.events.message.bind(this)(e)}onOpen(e){this.logger.log("Channel connected:",e),this.shouldReconnect=!0,this.events.open&&this.events.open.bind(this)(e)}onError(e){this.logger.error("Channel error:",e),this.connection.close(),this.events.error&&this.events.error.bind(this)(e)}onClose(e){this.logger.warn("Channel closed:",e),this.reconnect(),this.events.close&&this.events.close.bind(this)(e)}reconnect(){this.shouldReconnect&&(this.logger.log("Reconnecting"),this.connect())}}var i=s(306);const c={version:3,clusterId:"demo",apiKey:"oCdCMcMPQpbvNjUIzqtvF1d2X2okWpDQj4AwARJuAgtjhzKxVEjQU6IdCjwm",consoleLogs:!1,notifySelf:!0};class r{constructor(e){e=e||{},this.options={...c,...e},this.connections={},this.logger=new o(this.options)}subscribe(e){var t=this.getEndpoint(e);if(this.connections[e])return this.logger.log("Returning existing channel",t),this.connections[e];this.logger.log("Creating new channel",t);var s=new n(t,{channelId:e,...this.options});return this.connections[e]=s,s}unsubscribe(e){return!!this.connections[e]&&(this.connections[e].shouldReconnect=!1,this.connections[e].connection.close(),delete this.connections[e],!0)}getConnections(){return this.connections}getEndpoint(e){return`wss://${this.options.clusterId}.websocket.me/v${this.options.version}/${e}?api_key=${this.options.apiKey}&notify_self=${this.options.notifySelf}&source=jssdk&v=${i.version}`}}},138:(e,t,s)=>{e.exports=s(897).default}},t={};function s(o){if(t[o])return t[o].exports;var n=t[o]={exports:{}};return e[o](n,n.exports,s),n.exports}return s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s(138)})();